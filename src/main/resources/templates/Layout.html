<!DOCTYPE html>
<!--
Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
Click nbfs://nbhost/SystemFileSystem/Templates/Other/html.html to edit this template
-->
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="https://www.ultraq.net.nz/thymeleaf/layout">
    <head>
        <title>Usuarios Index</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
        <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script> 
        <style>
            .profile-img-detail {
              width: 150px;
              height: 150px;
              object-fit: cover;
              border-radius: 50%;
              border: 3px solid #dee2e6;
            }
        </style>
    </head>


    <body>
        <header>
            <nav class="navbar navbar-expand-lg navbar-primary bg-primary shadow-sm">
                <div class="container">
                    <a class="navbar-brand fw-bold" href="#">
                    </a>
                    <div class="alert alert-info my-3">
                        <span th:text="${serviceCount}" id="serviceCountLabel"></span>
                    </div>
                    <div class="ms-auto">
                        <form th:action="@{/auth/logout}" method="post">
                            <button  type="submit" class="btn btn-light px-4">
                                Logout
                            </button>
                        </form>
                    </div>
                </div>
            </nav>
        </header>
        <main layout:fragment="content"></main>
        <script th:inline="javascript">
            function actualizarServiceCount() {
                $.get("/usuario/serviceCount")
                  .done(function(data) {
                      $("#serviceCountLabel").text("Has usado " + data + " de 5 servicios disponibles.");
                  })
                  .fail(function(xhr) {
                      if (xhr.status === 401) {
                          window.location.href = "/auth/login?expired=true";
                      }
                  });
            }
            setInterval(actualizarServiceCount, 3000);

        </script>
    </body>
</html>
